<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<exportmultiplex category="Template" ref_path="workflow_data[Internal]/storable[workflow_data]/storable[Data]">
   <storable name="Audit Profile" null="true"/>
   <int name="Cancel batch count" value="0"/>
   <int name="Cancel batch type" value="0"/>
   <list classname="java.util.ArrayList" name="Comments"/>
   <storable name="Data Veracity Profile" null="true"/>
   <storable name="Error UDR type name" null="true"/>
   <boolean name="Error batch type" value="false"/>
   <string name="Error code" null="true"/>
   <map name="Error map" null="true"/>
   <storable name="Execution Config" storable-id="dr.WorkflowExecutionConfig" ver="10.0">
      <enum name="debugType" storable-id="dr.DebugType" value="EVENT"/>
      <storable name="executionSettings" storable-id="dr.ExecutionSettings" ver="11.0">
         <boolean name="enabled" value="false"/>
         <storable name="kafka" null="true"/>
      </storable>
      <int name="noOfFilesToKeep" value="0"/>
      <string name="throughputMIM" null="true"/>
      <string name="txnHandler" value="Default Handler"/>
   </storable>
   <list classname="java.util.ArrayList" name="Field Types"/>
   <boolean name="Log On CB" value="false"/>
   <list classname="java.util.ArrayList" name="Logged error MIM"/>
   <list classname="java.util.ArrayList" name="Nodes">
      <storable name="0" storable-id="dr.WfNode" ver="2.0">
         <string name="Classname" value="com.digitalroute.wfc.sql.coll.SQLCollInsp"/>
         <array classname="com.digitalroute.wf.WfNodeConfig" name="Configuration" size="1">
            <storable name="0" storable-id="dr.WfNodeConfig" ver="1.0">
               <string name="Classname" value="com.digitalroute.wfc.sql.coll.SQLCollInsp"/>
               <storable name="Data" storable-id="dr.SQLCollConfig" ver="8.0">
                  <storable name="dbProfile" storable-id="dr.DRConfiguration" ver="2.0">
                     <set name="Dynamic Parameters" null="true"/>
                     <string name="Folder" value="SAPCM-SEPT25_DB"/>
                     <string name="Key" value="DR1761390691431"/>
                     <string name="Name" value="PRF_DB_POSTGRES1"/>
                     <string name="Type" value="Database Profile"/>
                  </storable>
                  <int name="resultsetsize" value="0"/>
                  <string name="sql"><![CDATA[SELECT customer_name as custName,order_date as ordDate, order_id as orderId,product_name as productName,quantity FROM public.customer_orders where tranx_id >-1]]></string>
                  <array classname="java.lang.String" name="udrFields" size="5">
                     <string name="0" value="custName"/>
                     <string name="1" value="ordDate"/>
                     <string name="2" value="orderId"/>
                     <string name="3" value="productName"/>
                     <string name="4" value="quantity"/>
                  </array>
                  <storable name="udrTypeIdentifier" storable-id="dr.UltraClientInfo" ver="1.0">
                     <string name="FormatName" value="SAPCM-SEPT25_DB.UFL_DB"/>
                     <string name="TypeName" value="SAPCM-SEPT25_DB.UFL_DB.custOrd"/>
                  </storable>
               </storable>
            </storable>
         </array>
         <string name="Name" value="SQL_1"/>
      </storable>
      <storable name="1" storable-id="dr.WfNode" ver="2.0">
         <string name="Classname" value="com.digitalroute.wfc.analysis.StuffyMapperInsp"/>
         <array classname="com.digitalroute.wf.WfNodeConfig" name="Configuration" size="2">
            <storable name="0" storable-id="dr.WfNodeConfig" ver="1.0">
               <string name="Classname" value="com.digitalroute.wfc.analysis.StuffyMapperInsp"/>
               <storable name="Data" storable-id="dr.StuffyMapperData" ver="10.0">
                  <string name="sourceCode"><![CDATA[string updateQuery = "update customer_orders set tranx_id = -1 where order_id in(";
boolean rowsFetched;
beginBatch{
    rowsFetched = false;    
}
consume {
    debug(input);
    rowsFetched = true;
    updateQuery = updateQuery + "'"+input.orderId +"',";
}
drain{
    if(rowsFetched == true){
        string newQuery = strSubstring(updateQuery,0,strLength(updateQuery)-1);  
        newQuery = newQuery +")";
        debug(newQuery);
        int rowsUpdated =  sqlExec ("SAPCM-SEPT25_DB.PRF_DB_POSTGRES2", newQuery);
        
        debug(rowsUpdated);
    }
}]]></string>
                  <array classname="com.digitalroute.devkit.drudr.DRTypeInfo" name="udrTypes" size="1">
                     <storable name="0" storable-id="dr.UltraClientInfo" ver="1.0">
                        <string name="FormatName" value="SAPCM-SEPT25_DB.UFL_DB"/>
                        <string name="TypeName" value="SAPCM-SEPT25_DB.UFL_DB.custOrd"/>
                     </storable>
                  </array>
               </storable>
            </storable>
            <storable name="1" storable-id="dr.WfNodeConfig" ver="1.0">
               <string name="Classname" value="com.digitalroute.devkit.hidden.DRThreadBufferInsp"/>
               <storable name="Data" storable-id="dr.DRThreadBufferConfig" ver="10.0">
                  <boolean name="printStats" value="false"/>
                  <boolean name="useOwnThread" value="false"/>
               </storable>
            </storable>
         </array>
         <string name="Name" value="Analysis_1"/>
      </storable>
   </list>
   <list classname="java.util.ArrayList" name="Routes">
      <storable name="0" storable-id="dr.WfRoute" ver="2.0">
         <string name="Name" value="r_1"/>
         <int name="Realtime mode" value="0"/>
      </storable>
   </list>
   <list classname="java.util.ArrayList" name="Service"/>
   <boolean name="Template Valid" value="true"/>
</exportmultiplex>
